package jwt.utils

import jwt.utils.external.Jjwt
import spock.lang.Specification
import java.nio.file.Files
import java.nio.file.Path


class JjwtTest extends Specification {

    def "readPrivateKey works"() {
        given:
        def expected = """SunRsaSign RSA private CRT key, 2048 bits
  params: null
  modulus: 19528401785820274642298200447198693681372683818166413421385736601141636263840673511780857948065066192425480740569384065251977984752274011588349603209362220858474144363269608864544021309243923425464674153672851212250807075333774507183934992538194604415871746843975421033925806033725682694268564837941696215704563271984695037424643589594315690582441585451087124310764173323174976196329306739146932994562903732368923974808443398706152297094266693501167626217092999366858772558067591373600281117715445851609266122297286134574031931957290645285895752099696938240772735283025327358171112881542098865271180836995981447898543
  private exponent: 1910766077964699500186722162559494991101245631994020569520057920790099371986485785041957239299437523214800727053438139042499791373177855246811600021057345335535124444656703340767635635526903260231506218020769311969701090537830981389398097863057096004040123542990866035675255675286722618932773426054001968097467312259661106947832982999928248710074411857380750542921736381217021390714463044149444338915835812058875567805475585617478083362593774328408377385164105951793256490444260459262212275582290389836055024046342652289520943197538224770989856639834489941439382107055597634068387996679058256435389879776212248564973"""

        def key = Files.readString(Path.of("..", "mock_credentials", "private-key.pem"))

        when:
        def actual = Jjwt.getInstance().readPrivateKey(key)

        then:
        actual.toString() == expected
    }
}
